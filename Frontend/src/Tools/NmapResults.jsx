import React from 'react';

const NmapResults = ({ result }) => {
    if (!result) return null;

    const lines = result.split('\n');
    const sections = {
        Version: [],
        'Scan Report': [],
    };

    
    let currentSection = null;
    lines.forEach(line => {
        if (line.toLowerCase().includes('nmap version')) {
            currentSection = 'Version';
        } else if (line.toLowerCase().includes('nmap scan report')) {
            currentSection = 'Scan Report';
        } else if (line.includes('PORT')) {
            currentSection = 'Scan Report'; 
        }

        if (currentSection) {
            sections[currentSection].push(line);
        }
    });

    const styles = {
        container: {
            fontFamily: 'Arial, sans-serif',
            maxWidth: '800px',
            margin: '0 auto',
            padding: '20px',
            backgroundColor: '#ffffff',
            borderRadius: '10px',
            boxShadow: '0 2px 10px rgba(0,0,0,0.1)',
        },
        title: {
            textAlign: 'center',
            color: '#333',
            marginBottom: '30px',
            fontSize: '1.5em',
        },
        section: {
            marginBottom: '20px',
            padding: '10px',
            borderRadius: '8px',
            backgroundColor: '#f7f7f7',
            border: '1px solid #ccc',
        },
        sectionTitle: {
            fontSize: '1.2em',
            color: '#333',
            marginBottom: '10px',
        },
        versionDetail: {
            color: '#495057',
            marginBottom: '5px',
            lineHeight: '1.5',
        },
        table: {
            width: '100%',
            borderCollapse: 'collapse',
            marginTop: '10px',
        },
        tableHeader: {
            backgroundColor: '#e9ecef',
            padding: '10px',
            textAlign: 'left',
            fontWeight: 'bold',
            borderBottom: '2px solid #dee2e6',
        },
        tableCell: {
            padding: '10px',
            borderBottom: '1px solid #dee2e6',
        },
        ipAddress: {
            fontWeight: 'bold',
            color: '#007bff',
        },
        macAddress: {
            fontWeight: 'bold',
            color: '#28a745',
        },
    };

    return (
        <div style={styles.container}>
            <h2 style={styles.title}>Nmap Scan Results</h2>
            {sections.Version.length > 0 && (
                <div style={styles.section}>
                    <div style={styles.sectionTitle}>Nmap Version Information</div>
                    {sections.Version.map((item, index) => (
                        <p key={index} style={styles.versionDetail}>{item}</p>
                    ))}
                </div>
            )}
            {sections['Scan Report'].length > 0 && (
                <div style={styles.section}>
                    <div style={styles.sectionTitle}>Nmap Scan Report</div>
                    <table style={styles.table}>
                        <thead>
                            <tr>
                                <th style={styles.tableHeader}>Port</th>
                                <th style={styles.tableHeader}>State</th>
                                <th style={styles.tableHeader}>Service</th>
                            </tr>
                        </thead>
                        <tbody>
                            {sections['Scan Report'].map((item, index) => {
                                const portInfo = item.match(/(\d+\/tcp|\d+\/udp)\s+(\S+)\s+(.+)/);
                                if (portInfo) {
                                    const [_, port, state, service] = portInfo;
                                    return (
                                        <tr key={index}>
                                            <td style={styles.tableCell}>{port}</td>
                                            <td style={styles.tableCell}>{state}</td>
                                            <td style={styles.tableCell}>{service}</td>
                                        </tr>
                                    );
                                }
                                if (item.startsWith('Nmap scan report for')) {
                                    return <tr key={index}><td colSpan="3" style={{ ...styles.tableCell, ...styles.ipAddress }}>{item}</td></tr>;
                                }
                                if (item.startsWith('MAC Address')) {
                                    return <tr key={index}><td colSpan="3" style={{ ...styles.tableCell, ...styles.macAddress }}>{item}</td></tr>;
                                }
                                return null;
                            })}
                        </tbody>
                    </table>
                </div>
            )}
        </div>
    );
};

export default NmapResults;
